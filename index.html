<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>VslicR5 - Mobile Support Update</title>
<link rel="shortcut icon" type="image/png" href="favicon.png">
<link rel="stylesheet" href="stylish.css">
<!-- Enable standalone (fullscreen) mode on iOS -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="VslicR5">

<style>
  /* All CSS moved inline as requested */
  * {
    -webkit-tap-highlight-color: transparent;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    user-select: none;
    box-sizing: border-box;
  }

  textarea, input {
    -webkit-user-select: text;
    user-select: text;
  }

  body {
    font-family: Arial, sans-serif;
    background: #111;
    color: #eee;
    margin: 0;
    padding: 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
    overscroll-behavior: none;
    touch-action: manipulation;
  }

  .logo-container {
    width: 100%;
    display: flex;
    justify-content: center;
    margin-bottom: 20px;
  }

  .logo-container img {
    width: 160px;
    height: 160px;
    image-rendering: pixelated;
    object-fit: contain;
    cursor: pointer;
  }

  .main-content {
    display: flex;
    width: 100%;
    gap: 12px;
  }

  textarea {
    width: 320px;
    height: 90vh;
    background: #1e1e1e;
    color: #0f0;
    border: 1px solid #444;
    padding: 8px;
    font-family: monospace;
    font-size: 11px;
    outline: none;
  }

  .right {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  canvas {
    background: #000;
    border: 1px solid #444;
    width: 100%;
    max-width: 900px;
  }

  .row {
    display: flex;
    gap: 6px;
    flex-wrap: wrap;
    align-items: center;
  }

  button, .upload-btn {
    width: 44px;
    height: 44px;
    background: #222;
    color: #fff;
    border: 1px solid #555;
    border-radius: 6px;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
  }

  button:active, .upload-btn:active { background: #444; }

  button img, .upload-btn img {
    object-fit: contain;
    pointer-events: none;
  }

  .mobile-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-top: 10px;
    background: #222;
    padding: 15px;
    border-radius: 8px;
  }

  .btn-group {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
  }

  .pad {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 8px;
  }

  .m-btn {
    width: 40px;
    height: 40px;
    font-size: 24px;
    font-weight: bold;
    background: transparent;
    border: none;
  }

  .opponent-btn { background: rgba(153, 0, 0, 0.2) !important; }
  .player-btn { background: rgba(0, 85, 255, 0.2) !important; }

  @media (max-width: 800px) {
    .main-content { flex-direction: column; }
    textarea { width: 100%; height: 200px; }
  }
</style>
</head>

<body>

<div class="logo-container" id="logoWrapper">
  <img 
    src="logo.png" 
    alt="VslicR5 Logo" 
    title="click me to hide:)" 
    onclick="this.parentElement.style.display='none'"
  >
</div>

<div class="main-content">
  <textarea id="jsonInput" spellcheck="false"></textarea>

  <div class="right">
    <canvas id="chart" width="900" height="400"></canvas>

    <div class="row">
      <label class="upload-btn">
        <img src="import.png" alt="import JSON" />
        <input type="file" accept=".json" onchange="importJSON(this)" hidden />
      </label>
      <label class="upload-btn">
        <img src="music.png" alt="import Audio" />
        <input type="file" accept=".ogg,.wav,.mp3,audio/*" onchange="importAudio(this)" hidden />
      </label>
      <button onclick="playAudio()"><img src="play.png"/></button>
      <button onclick="pauseAudio()"><img src="pause.png"/></button>
      <button onclick="stopAudio()"><img src="stop.png"/></button>
    </div>

    <div class="row">
      <button onclick="seekTime(-100)">-100ms</button>
      <button onclick="seekTime(100)">+100ms</button>
      <span id="timeLabel">Time: 0 ms - 0 ms</span>
    </div>

    <div class="mobile-grid">
      <div class="btn-group">
        <small>OPPONENT (WASD)</small>
        <div class="pad">
          <button class="m-btn opponent-btn" onmousedown="addNote(4)">A</button>
          <button class="m-btn opponent-btn" onmousedown="addNote(5)">S</button>
          <button class="m-btn opponent-btn" onmousedown="addNote(6)">W</button>
          <button class="m-btn opponent-btn" onmousedown="addNote(7)">D</button>
        </div>
      </div>
      <div class="btn-group">
        <small>PLAYER (Arrows)</small>
        <div class="pad">
          <button class="m-btn player-btn" onmousedown="addNote(0)"><img src="https://raw.githubusercontent.com/mcmattyobriore/vslicr5/main/system/button-arrows/leftBIG.png"/></button>
          <button class="m-btn player-btn" onmousedown="addNote(1)"><img src="https://raw.githubusercontent.com/mcmattyobriore/vslicr5/main/system/button-arrows/downBIG.png"/></button>
          <button class="m-btn player-btn" onmousedown="addNote(2)"><img src="https://raw.githubusercontent.com/mcmattyobriore/vslicr5/main/system/button-arrows/upBIG.png"/></button>
          <button class="m-btn player-btn" onmousedown="addNote(3)"><img src="https://raw.githubusercontent.com/mcmattyobriore/vslicr5/main/system/button-arrows/downBIG.png"/></button>
        </div>
      </div>
    </div>

    <div class="row">
      <!-- Trash button resets to original JSON structure -->
      <button 
        onclick="if(confirm('Are you sure you want to reset the chart?')){ resetToDefault(); }"
        onmouseenter="this.querySelector('img').src='https://raw.githubusercontent.com/mcmattyobriore/vslicr5/main/system/trash/trash_eager.png'"
        onmouseleave="this.querySelector('img').src='https://raw.githubusercontent.com/mcmattyobriore/vslicr5/main/system/trash/trash_closed.png'">
        <img src="https://raw.githubusercontent.com/mcmattyobriore/vslicr5/main/system/trash/trash_closed.png" alt="Trash"/>
      </button>
<button onclick="saveToLocalStorage()">
  <img src="save.png" alt="save" />
</button>
      <button onclick="exportJSON()"><img src="export.png"/></button>
    </div>

    <audio id="audio"></audio>
  </div>
</div>

<script>
  // Inline helper for the reset logic
  function resetToDefault() {
    const defaultData = {
      "version": "2.0.0",
      "scrollSpeed": {
        "easy": 1.8,
        "normal": 2,
        "hard": 2.2
      },
      "events": [],
      "notes": {
        "easy": [],
        "normal": [],
        "hard": []
      },
      "generatedBy": "VslicR5 - FNF v0.8.0"
    };
    
    // Update the visual data and the text area
    if (typeof chartData !== 'undefined') chartData = defaultData;
    document.getElementById('jsonInput').value = JSON.stringify(defaultData, null, 2);
    
    // Refresh canvas if function exists
    if (typeof drawChart === 'function') drawChart();
  }
</script>
<script src="scriptish.js"></script>
</body>
</html>
